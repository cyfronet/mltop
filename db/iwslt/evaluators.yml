if:
  name: Instruction-Following
  script: |
    #!/bin/bash -l

    #SBATCH -A plgmeetween2025-gpu-a100
    #SBATCH -p plgrid-gpu-a100
    #SBATCH -N 1
    #SBATCH --ntasks-per-node=1
    #SBATCH --gres=gpu:1
    #SBATCH --mem=50G
    #SBATCH --job-name=IF
    #SBATCH --output /net/pr2/projects/plgrid/plggmeetween/mltop/iwslt/if-%j.out
    #SBATCH --error /net/pr2/projects/plgrid/plggmeetween/mltop/iwslt/if-%j.err

    curl --retry 5 --retry-max-time 600 --retry-connrefused -L -o $SCRATCHDIR/ref $GROUNDTRUTH_URL
    curl --retry 5 --retry-max-time 600 --retry-connrefused -L -o $SCRATCHDIR/hyp $HYPOTHESIS_URL

    calculator_script=/net/pr2/projects/plgrid/plggmeetween/evaluation/run-IWSLT25-IF__athena.sh

    output=$(bash $calculator_script $SCRATCHDIR/input $SOURCE_LANGUAGE $TARGET_LANGUAGE $SCRATCHDIR/hyp $SCRATCHDIR/ref)

    if [ "$?" -eq 0 ]; then
      echo "Submitting output: $output"
      curl -X POST $RESULTS_URL -L --location-trusted -H "Content-Type:application/json" -H "Authorization:Token $TOKEN" -d "$output"
    else
      echo "Error while calculating scores"
      exit 1
    fi
  host: athena.cyfronet.pl
  metrics:
    - name: SQA-BERTScore
      order: desc
      worst_score: -1
      best_score: 1
    - name: SSUM-BERTScore
      order: desc
      worst_score: 0
      best_score: 1
    - name: ASR-WER
      order: asc
      worst_score: 1
      best_score: 0
    - name: ST-COMET
      order: desc
      worst_score: -1
      best_score: 1
  tasks:
    - IFLONG
    - IFSHORT
  to: text

comet:
  name: Comet
  script: |
    #!/bin/bash -l

    #SBATCH -A plgmeetween2025-gpu-a100
    #SBATCH -p plgrid-gpu-a100
    #SBATCH -N 1
    #SBATCH --ntasks-per-node=1
    #SBATCH --mem=50G
    #SBATCH --job-name=comet
    #SBATCH --time=00:10:00
    #SBATCH --output /net/pr2/projects/plgrid/plggmeetween/mltop/iwslt/comet-%j.out
    #SBATCH --error /net/pr2/projects/plgrid/plggmeetween/mltop/iwslt/comet-%j.err

    curl --retry 5 --retry-max-time 600 --retry-connrefused -L -o $SCRATCHDIR/internal $INTERNAL_URL
    curl --retry 5 --retry-max-time 600 --retry-connrefused -L -o $SCRATCHDIR/ref $GROUNDTRUTH_URL
    curl --retry 5 --retry-max-time 600 --retry-connrefused -L -o $SCRATCHDIR/hyp $HYPOTHESIS_URL

    calculator_script=/net/pr2/projects/plgrid/plggmeetween/evaluation/run-comet__athena.sh

    output=$(bash $calculator_script $SOURCE_LANGUAGE $TARGET_LANGUAGE $SCRATCHDIR/internal $SCRATCHDIR/hyp $SCRATCHDIR/ref)

    if [ "$?" -eq 0 ]; then
      echo "Submitting output: $output"
      curl -X POST $RESULTS_URL -L --location-trusted -H "Content-Type:application/json" -H "Authorization:Token $TOKEN" -d "$output"
    else
      echo "Error while calculating scores"
      exit 1
    fi
  host: athena.cyfronet.pl
  metrics:
    - name: comet
      order: desc
      worst_score: 0
      best_score: 1
  tasks:
    - OFFLINE
    - MODELCOMPRESSION
  to: text

screbleu:
  name: SacreBLEU
  script: |
    #!/bin/bash -l

    #SBATCH -A plgmeetween2025-cpu
    #SBATCH -p plgrid
    #SBATCH -N 1
    #SBATCH --ntasks-per-node=1
    #SBATCH --mem=512M
    #SBATCH --job-name=sacrebleu
    #SBATCH --time=00:02:00
    #SBATCH --output /net/pr2/projects/plgrid/plggmeetween/mltop/iwslt/sacrebleu-%j.out
    #SBATCH --error /net/pr2/projects/plgrid/plggmeetween/mltop/iwslt/sacrebleu-%j.err

    curl --retry 5 --retry-max-time 600 --retry-connrefused -L -o $SCRATCHDIR/ref $GROUNDTRUTH_URL
    curl --retry 5 --retry-max-time 600 --retry-connrefused -L -o $SCRATCHDIR/hyp $HYPOTHESIS_URL

    calculator_script=/net/pr2/projects/plgrid/plggmeetween/evaluation/run-sacrebleu__ares.sh

    output=$(bash $calculator_script $SOURCE_LANGUAGE $TARGET_LANGUAGE $SCRATCHDIR/hyp $SCRATCHDIR/ref)
    if [ "$?" -eq 0 ]; then
      echo "Submitting output: $output"
      curl -X POST $RESULTS_URL -L --location-trusted -H "Content-Type:application/json" -H "Authorization:Token $TOKEN" -d "$output"
    else
      echo "Error while calculating scores"
      exit 1
    fi
  host: ares.cyfronet.pl
  metrics:
    - name: bleu
      order: desc
      worst_score: 0
      best_score: 100
    - name: chrf
      order: desc
      worst_score: 0
      best_score: 100
    - name: ter
      order: asc
      worst_score: 100
      best_score: 0
  tasks:
    - OFFLINE
  to: text

bleurt:
  name: BLEURT
  script: |
    #!/bin/bash -l

    #SBATCH -A plgmeetween2025-gpu-a100
    #SBATCH -p plgrid-gpu-a100
    #SBATCH -N 1
    #SBATCH --ntasks-per-node=1
    #SBATCH --gres=gpu:1
    #SBATCH --mem=50G
    #SBATCH --job-name=bleurt
    #SBATCH --time=00:10:00
    #SBATCH --output /net/pr2/projects/plgrid/plggmeetween/mltop/iwslt/bleurt-%j.out
    #SBATCH --error /net/pr2/projects/plgrid/plggmeetween/mltop/iwslt/bleurt-%j.err

    curl --retry 5 --retry-max-time 600 --retry-connrefused -L -o $SCRATCHDIR/ref $GROUNDTRUTH_URL
    curl --retry 5 --retry-max-time 600 --retry-connrefused -L -o $SCRATCHDIR/hyp $HYPOTHESIS_URL

    calculator_script=/net/pr2/projects/plgrid/plggmeetween/evaluation/run-bleurt__athena.sh

    output=$(bash $calculator_script $SOURCE_LANGUAGE $TARGET_LANGUAGE $SCRATCHDIR/hyp $SCRATCHDIR/ref)
    if [ "$?" -eq 0 ]; then
      echo "Submitting output: $output"
      curl -X POST $RESULTS_URL -L --location-trusted -H "Content-Type:application/json" -H "Authorization:Token $TOKEN" -d "$output"
    else
      echo "Error while calculating scores"
      exit 1
    fi
  host: athena.cyfronet.pl
  metrics:
    - name: bleurt
      order: asc
      worst_score: 1
      best_score: 0
  tasks:
    - OFFLINE
  to: text

characTER:
  name: CharacTER
  script: |
    #!/bin/bash -l

    #SBATCH -A plgmeetween2025-cpu
    #SBATCH -p plgrid
    #SBATCH -N 1
    #SBATCH --ntasks-per-node=1
    #SBATCH --mem=512M
    #SBATCH --job-name=characTER
    #SBATCH --time=00:10:00
    #SBATCH --output /net/pr2/projects/plgrid/plggmeetween/mltop/iwslt/character-%j.out
    #SBATCH --error /net/pr2/projects/plgrid/plggmeetween/mltop/iwslt/character-%j.err

    curl --retry 5 --retry-max-time 600 --retry-connrefused -L -o $SCRATCHDIR/ref $GROUNDTRUTH_URL
    curl --retry 5 --retry-max-time 600 --retry-connrefused -L -o $SCRATCHDIR/hyp $HYPOTHESIS_URL

    calculator_script=/net/pr2/projects/plgrid/plggmeetween/evaluation/run-characTER__ares.sh

    output=$(bash $calculator_script $TARGET_LANGUAGE $SCRATCHDIR/hyp $SCRATCHDIR/ref)

    if [ "$?" -eq 0 ]; then
      echo "Submitting output: $output"
      curl -X POST $RESULTS_URL -L --location-trusted -H "Content-Type:application/json" -H "Authorization:Token $TOKEN" -d "$output"
    else
      echo "Error while calculating scores"
      exit 1
    fi
  host: ares.cyfronet.pl
  metrics:
    - name: characTER
      order: asc
      worst_score: 1
      best_score: 0
  tasks:
    - OFFLINE
  to: text
